#!/bin/sh
set -v
#
# kubernetes va a poner los secrets en variables de entorno
# el resto es el PROFILE "prod"
#
# quito  -Xmx => esto lo decide docker
 
[ -f target/fcm-platform-*.jar ] && echo "estoy en el proyecto. traigo el jar desde target" && cp target/fcm-platform-*.jar  fcm-platform-final.jar

base_path=`dirname $0`

java_args="-Dspring.profiles.active=prod \
  -Djava.security.egd=file:/dev/./urandom
  -jar $base_path/fcm-platform-final.jar \
  --debug=false \
  --spring.datasource.maxActive=16 \
  --spring.h2.console.enabled=false \
  --spring.datasource.url=${DS_URL} \ 
  --spring.datasource.username=${DS_USERNAME}\
  --spring.datasource.password=${DS_PASSWORD}\
  "

java $java_args $@ | sed -e "s/^/$PROC: /"

sleep 20000000