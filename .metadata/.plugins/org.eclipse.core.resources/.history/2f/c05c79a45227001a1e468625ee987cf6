package com.meli.currency;

import java.sql.Timestamp;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.ApplicationArguments;
import org.springframework.boot.ApplicationRunner;
import org.springframework.stereotype.Component;

import com.meli.currency.model.CurrencyConversion;
import com.meli.currency.repository.CurrencyConversionRepository;

@Component
public class CurrencyConversionLoader implements ApplicationRunner {

	@Autowired
	private CurrencyConversionRepository currencyConversionRepo;

	@Override
	public void run(ApplicationArguments args) throws Exception {
		//currency conversion
		Timestamp now = DateHelper.getInstance().getNow();

		//USD
		CurrencyConversion cc = new CurrencyConversion();

		Currency currency = new Currency();
		currency.setDescription("DÃ³lar");
		currency.setName("USD");
		currency.setPredeterminado(false);

		cc.setCurrency(currency);
		cc.setConversionfactor(60d);
		cc.setSince(now);

		currencyConversionRepo.save(cc);

		//ARS
		cc = new CurrencyConversion();

		currency = new Currency();
		currency.setDescription("Peso argentino");
		currency.setName("ARS");
		currency.setPredeterminado(true);

		cc.setCurrency(currency);
		cc.setConversionfactor(1d);
		cc.setSince(now);

		currencyConversionRepo.save(cc);

	}

}